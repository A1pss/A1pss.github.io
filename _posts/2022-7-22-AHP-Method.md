---
title: 第一讲：层次分析法 (AHP)
layout: post
post-image: "https://alps-images.obs.cn-east-2.myhuaweicloud.com/img/image-20230722185917433.png"
description: 数学建模算法笔记
tags:
- mathematics modeling
- knowledge
---


> **声明：**
>
> 笔记为本人个人整理，参考清风大佬的视频课件，若有错误请指出。


用于解决评价类问题

---
### AHP简介
> 1. 我们的评价目标是什么
> 2. 为了达到目标有几种可选方案
> 3. 评价的准则是什么（根据什么评价好坏）
- 判断矩阵（“分而治之”）：一次性确定三个及以上指标之间的关系（权重）容易考虑不周，我们采用画表格并两两比对的方式确定这几个关系之间的权重。
- 一致性检验：检验判断矩阵是否正确、能用、客观
- 通过几个判断矩阵计算权重
### 具体步骤
1. 列出可选方案

2. 列出评价指标

3. 制作评价指标权重的判断矩阵

4. 制作可选方案权重的判断矩阵

5. 对所有判断矩阵一致性检验：
	- 计算一致性指标CI
	  $$
	  CI=\frac{\lambda_\max-n}{n-1}
	  $$
	  *$n$为一致矩阵特征值*
	  
	- 查找对应的平均随机一致性指标RI
	
	  | n    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   |
	  | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
	  | RI   | 0    | 0    | 0.52 | 0.89 | 1.12 | 1.26 | 1.36 | 1.41 | 1.46 | 1.49 | 1.52 | 1.54 | 1.56 | 1.58 | 1.59 |
	
	- 计算一致性比例CR
	  $$
	  CR=\frac{CI}{RI}
	  $$
	  如果CR < 0.1， 则可认为判断矩阵一致性可接受
	
	  *如果特征值中有虚数，则比较的是特征值的模长*

6. 通过可选方案与评价指标的判断矩阵计算权重

   > 一、算术平均法求权重
   >
   > - 判断矩阵归一化（每一个元素除以所在列的和）
   > - 归一化后的矩阵每行求和再除以列数，得出的就是权重
   >
   > 二、几何平均法求权重
   >
   > - 将判断矩阵每列求乘积，并开n次方 (n为列数)
   > - 将n列的乘积进行归一化处理，得到权重
   >
   > 三、特征值法求权重
   >
   > - 求出矩阵的最大特征值以及其对应的特征向量
   > - 对求出的特征向量归一化可得到权重

   为了保证结果的稳健性，论文可以采用三种方法分别求出了权重后计算平均值，再根据得到的权重矩阵计算各方案的得分，并进行排序和综合分析。这样避免了采用单一方法所产生的偏差，得出的结论将更全面、更有效。(这段话可以加到论文中)

7. 汇总结果得到权重矩阵，根据权重矩阵求各可选方案的评分

### 局限性

- 决策层不能太多，太多的话n会很大，判断矩阵和一致矩阵差异可能会很大
- 若决策层中的指标是已知的 (如成绩、速度、时间等等)，那么有其他方法比AHP更加准确

### 代码

```matlab
clear;clc
disp('输入判断矩阵A: ')
A = input('判断矩阵A=');
% 一致性检验
[n,n] = size(A);
[V,D] = eig(A);
maxeig = max(max(D));
CI = (maxeig - n) / (n-1);
RI=[0 0 0.52 0.89 1.12 1.26 1.36 1.41 1.46 1.49 1.52 1.54 1.56 1.58 1.59];
CR=CI/RI(n);
disp('一致性指标CI=');disp(CI);
disp('一致性比例CR=');disp(CR);
if CR<0.10
    disp('因为CR < 0.10，所以该判断矩阵A的一致性可以接受!');
else
    disp('注意：CR >= 0.10，因此该判断矩阵A需要进行修改!');
end
% 算术平均法
sumA1 = sum(A);
sumA2 = repmat(sumA1,n,1);
normalA = A ./ sumA2;
sum(normalA,2);
disp('算术平均法求权重的结果为：');
disp(sum(normalA,2) ./ n)
M1 = sum(normalA,2) ./ n;
% 几何平均法
productA1 = prod(A,2);
productA2 = productA1 .^ (1/n);
disp('几何平均法求权重的结果为：');
disp(productA2 ./ sum(productA2))
M2 = productA2 ./ sum(productA2);
% 特征值法
D == maxeig;
[r,c] = find(D == maxeig,1);
V(:,c);
disp('特征值法求权重的结果为：');
disp(V(:,c) ./ sum(V(:,c)))
M3 = V(:,c) ./ sum(V(:,c));
% 平均权重
AM = (M1 + M2 + M3) / 3;
disp('平均权重为：')
disp(AM)
```





