---
title: 第三讲：插值算法
layout: post
post-image: "https://alps-images.obs.cn-east-2.myhuaweicloud.com/img/image-20230722185917433.png"
description: 数学建模算法笔记
tags:
- mathematics modeling
- knowledge
---


> **声明：**
>
> 笔记为本人个人整理，参考清风大佬的视频课件，若有错误请指出。


数据极少，不足以支撑分析的进行时，“模拟产生”一些新的但又比较靠谱的值来满足需求，这就是插值

---

### 插值法的定义
> 设函数$y=f(x)$在区间$[a,b]$上有定义，且已知点$a\leqslant x_0<x_1<\dots \leqslant b$上的值分别为：$y_0,y_1,\dots,y_n$。若存在以简单函数$P(x)$，使$P(x_i)=y_i\ \ (i=0,1,2,\dots,n)$则称$P(x)$为$f(x)$的插值函数，点$x_0,x_1,\dots,x_n$成为插值节点，区间$[a,b]$成为插值区间，求插值函数$P(x)$的方法称为插值法
> > - 分类:
> >   若$P(x)$是$n$次代数多项式，即$P(x)=a_0+a_1x+\dots+a_nx^n$，就称为多项式插值；
> >   若$P(x)$为分段多项式，就称为分段插值；
> >   若$P(x)$为三角多项式，就称为三角插值。
> > - 原理:
> >   设有$n+1$个互不相同界的节点$(x_i,y_i)\ \ (i=0,1,2,\dots,n)$，则存在**唯一**的多项式：$L_n(x)=a_0+a_1x+a_2x^2+\dots+a_nx^n$使得$L_n(x_j)=y_j\ \ (j=0,1,2,\dots，n)$
> >   *注：如果不限制多项式的次数，插值多项式并不唯一*

### 多项式插值方法
#### 1. 拉格朗日插值法

1. 拉格朗日插值多项式 ($L_n(x)$) ：
   $$
   \omega _{n+1}(x)=(x-x_0)(x-x_1)\dots(x-x_n)\\\omega _{n+1}'(x_k)=(x_k-x_0)\dots(x_k-x_{k-1})(x_k-x_{k+1})\dots(x_k-x_n)\\L_n(x)=\sum_{k=0}^{n}{y_k\frac{\omega _{n+1}(x)}{(x-x_k)\omega _{n+1}'(x_k)}}.
   $$

2. 龙格现象：

   高次插值会产生龙格现象，即在两端处波动极大，产生明显的震荡。在不熟悉曲线运动趋势的前提下，不要轻易使用高次插值。

### 分段线性插值方法

#### 2. 分段二次插值 (分段抛物插值) 

- 插值多项式次数高，精度未必显著提高；

  插值多项式次数越高，舍入误差可能显著增大；

  所以采用分段低次插值是一种办法

- 选取跟节点$x$最近的三个节点$x_{i-1},\ x_i,\ x_{i+1}$进行二次插值。

  即在每个区间$[x_{i-1},\ x_{i+1}]$上，取：
  $$
  f(x)\thickapprox L_2(x)=\sum_{\substack{k=i-1\\j\neq k}}^{i+1}[y_k\prod_{j=i-1}^{i+1}{\frac{(x-x_j)}{(x_k-x_j)}}]
  $$


#### 3. 牛顿插值法

$$
f(x)=f(x_0)+f[x_0,x_1](x-x_0)\\+f[x_0,x_1,x_2](x-x_0)(x-x_1)+\dots\\+f[x_0,x_1,\dots,x_{n-2},x_{n-1}](x-x_0)(x-x_1)\dots(x-x_{n-3})(x-x_{n-2})\\+f[x_0,x_1,\dots,x_{n-1},x_{n}](x-x_0)(x-x_1)\dots(x-x_{n-2})(x-x_{n-1})\\\\f[x_0,x_1,\dots,x_k]=\frac{f[x_1,\dots,x_{k-1},x_k]-f[x_0,x_1,\dots,x_{k-1}]}{x_k-x_0}
$$

*也存在龙格现象的问题*

- 拉格朗日插值法和牛顿插值法的缺点：

  仅仅要求插值多项式在插值节点处与被插函数有相等的函数值，而这种插值多项式却不能全面反映被插值函数的性态。
  
  例如插值函数与被插值函数不能在所有节点处有相同的函数值，或在一个或全部节点上插值多项式与被插函数有相同的低阶甚至高阶的导数值

#### 4. 埃尔米特 (Hermite) 插值

- 优点：既能满足在节点上函数值相等，还要求对应的导数值也相等，甚至高阶导数

- 原理：

  ​		设函数$f(x)$在区间$[a,\ b]$上有$n+1$个互异节点$a=x_0<x_1<X_2<\dots<x_n=b$，定义在$[a,\ b]$上函数$f(x)$在节点上满足：
  $$
  f(x_i)=y_i,f'(x_i)=y_i'\ \ (i=0,1,2,\dots,n)\ \ (2n+2个条件)
  $$
  可唯一确定一个次数不超过$2n+1$的多项式$H_{2n+1}(x)=H(x)$满足：
  $$
  H(x_j)=y_j,\ \ H'(x_j)=m_j\ \ (j=0,1,\dots,n).
  $$
  其余项为：
  $$
  R(x)=f(x)-H(x)=\frac{f^{2n+2(\xi)}}{(2n+2)!}\omega _{2n+2}(x)
  $$
  
- 分段三次埃尔米特插值

  直接使用Hermite插值得到的多项式次数较高，也存在着龙格现象，因此我们往往采用分段三次Hermite插值多项式 (PCHIP)

  **MATLAB中有内置函数，直接调用：**

  **`p = pchip(x, y, xnew_x)`**

  x是已知的样本点的横坐标，y是一致的样本点的纵坐标，new_x是要插入点的横坐标

#### 5. 三次样条插值

- 设$y=f(x)$在点$x_0,x_1,x_2,\dots,x_n$的值为$y_0,y_1,y_2,\dots,y_n$，若函数$S(x)$满足下列条件

  (1) $S(x_i)=f(x_i)=y_i,\ \ i=0,1,2,\dots,n$

  (2) 在每个子区间$[x_i,x_{i+1}](i=0,1,2,\dots,n-1)$上$S(x)$是三次多项式

  (3) $S(x)$在$[a,b]$上二姐连续可微。

  则称$S(x)$为函数$f(x)$的三次样条插值函数

- **Matlab有内置的函数：**

  **`p = spline(x, y, new_x)`**

  x是已知的样本点的横坐标，y是一致的样本点的纵坐标，new_x是要插入点的横坐标

- 对比三次埃尔米特插值和三次样条插值：

  三次样条生成的曲线更加光滑。在实际建模中， 由于我们不知道数据的生成过程，因此这两种插值都可以使用。

### n维数据的插值 (代码)

`p = interpn(x1, x2, ..., xn, y, new_x1, new_x2, ..., new_xn, method)`

x1, x2, ..., xn是已知的样本点的横坐标，

y是一致的样本点的纵坐标， 

new_x1, new_x2, ..., new_xn是要插入点的横坐标，

method是要插值的方法：

​	'linear': 线性插值（默认）；

​	'cubic': 三次插值；

​	'spline': 三次样条插值法（最为精准）；

​	'nearest': 最邻近插值算法。
