---
title: 第九讲：分类模型
layout: post
post-image: "https://alps-images.obs.cn-east-2.myhuaweicloud.com/img/image-20230722185917433.png"
description: 数学建模算法笔记
tags:
- mathematics modeling
- knowledge
---


> **声明：**
>
> 笔记为本人个人整理，参考清风大佬的视频课件，若有错误请指出。


## 逻辑回归

把y看成事件发生的概率，y>=0.5表示发生；y<0.5表示不发生

### 二分类问题

#### 数据预处理

- 生成虚拟变量

  转换 - 创建虚变量

#### 数学理论

- 线性概率模型(LPM)
  $$
  y_i=\beta_0+\beta_1x_{1i}+\beta_1x_{2i}+\cdots+\beta_kx_{ki}+\mu_i
  $$
  写成向量乘机形式：$y_i=x_i'\beta+\mu_i\ (i=1,2,\cdots,n)$

  问题1(内生性问题)：yi只能取0或1，也就是μi会是$1-x_i'\beta或-x_i'\beta$，与自变量都有关。

  问题2：预测值可能会出现 >1 或 <0 的情况。

- 两点分布(伯努利分布)

  设两个事件其中一个事件的概率是$F(x,\beta)$，称 F 为连接函数，它将x和y连接起来

- 连接函数的取法

  1. $F(x,\beta)$可以取为标准正态分布的累计密度函数(cdf)：
     $$
     F(x,\beta)=\Phi(x_i'\beta)=\int_{-\infty}^{x_i'\beta}\frac{1}{\sqrt{2\pi}}e^{-\frac{t^2}{2}}dt
     $$
     这是probit回归

  2. $F(x,\beta)$可以取为Sigmoid函数：
     $$
     F(x,\beta)=S(x_i'\beta)=\frac{exp(x_i'\beta)}{1+xep(x_i'\beta)}
     $$
     这是logistic回归。这种回归有解析表达式而上面那种带着积分符号，所以通常计算logistic回归模型。

- 怎么求解logistic回归模型的连接函数

  使用极大似然估计法(MLE)进行估计

#### 用SPSS求解逻辑回归

1. 数据预处理

   为待分类的变量生成虚变量；

   删去虚变量列中需要预测的几个格

2. 分析 - 回归 - 二元logistic... - 选择因变量，协变量(也就是自变量)

3. 方法：“向后”中任选一个

   |                             分类                             |       保存       |                             选项                             | 样式   |                           自助抽样                           |
   | :----------------------------------------------------------: | :--------------: | :----------------------------------------------------------: | ------ | :----------------------------------------------------------: |
   | 将定性变量移动到分类协变量中转化为虚拟变量；对比选择指示符；参考类别任选一个 | 勾选概率与组成员 | 步进概率(显著性水平)：如果是向前回归则调整进入概率，向后回归调整除去概率；最大迭代次数自己调整 | 不用管 | (用的非常少) 如果样本数量非常少则可以从已有样本中随机抽取当作新样本以增加样本数量 |

3. 生成的报告

   - 分类表：体现预测成功率
   - 方程中的变量：B列对应回归系数$\hat{\beta_i}$，带入$\hat{y_i}$中假如大于等于0.5则是变量1。

4. 数据视图中新添的两列：PRE_1是预测值，PGR_1是预测的类别

5. 预测结果较差怎么办？

   可在logistic回归模型中加入平方项、交互项等。

   转换 - 计算变量 - 变量\*变量是平方项，变量1\*变量2是交互项

   \*注意：加入平方项、交互项后可能出现过拟合现象，所以用第6点来弥补

6. 把数据分为训练组和测试组，用训练组的数据来估计出模型，再用测试组的数据来进行测试。(训练组和测试组的比例一般设置为80%和20%)

   (注意：为了消除偶然性的影响，可以对上述步骤多重复几次，最
   终对每个模型求一个平均的准确率，这个步骤称为交叉验证。)

### 多分类问题

- 分析 - 回归 - 多元logistic回归 - 添加因变量和因子(自变量)

  保存：勾选前两个

- 结果分析

  参数视图中，EST列指预测分类的概率，PRE是预测结果

- 也存在过拟合问题，需要把数据分为训练组和测试组，用训练组的数据来估计出模型，再用测试组的数据来进行测试。(训练组和测试组的比例一般设置为80%和20%)

  (注意：为了消除偶然性的影响，可以对上述步骤多重复几次，最
  终对每个模型求一个平均的准确率，这个步骤称为交叉验证。)


## Fisher线性判别分析

又称LDA(Linear Discriminant Analysis)，是一种经典的线性判别方法

该方法思想比较简单：给定训练集样例，设法将样例投影到一维的直线上，使得同类样例的投影点尽可能接近和密集，异类投影点尽可能远离。(二分类是一维直线，多分类是高维)

### 二分类问题

核心是找到线性系数向量ω

#### SPSS操作

- 分析 - 分类 - 判别式(指Fisher线性判别分析) - 输入分组变量(因变量)和自变量，定义范围(0到1)

  统计：勾选费希尔和未标准化

  分类：勾选摘要表

  保存：勾选第一、三个

- 生成的报告

  典型判别函数系数：线性系数向量ω

  分类结果：看准确率

  分类函数系数：贝叶斯判别函数系数表，作用是将样本各个参数带入2个贝叶斯判别函数，比较得出的函数值哪个大就将样品归于哪类

- 数据视图

  Dis_1列：预测的类别

  Dis1_1, Dis2_1, ...：属于1的概率和属于0的概率
  

#### 需要放到论文中

线性系数向量ω表，未知样品的分类结果，成功率

### 多分类问题

- 分析 - 分类 - 判别式(指Fisher线性判别分析) - 输入分组变量(因变量)和自变量，定义范围(1到n)

  统计：勾选费希尔和未标准化

  分类：勾选摘要表

  保存：勾选第一、三个

- 其他类似于二分类的Fisher

  